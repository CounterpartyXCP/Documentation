"use strict";(self.webpackChunkxcpdoc=self.webpackChunkxcpdoc||[]).push([[5895],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>h});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},c="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),c=p(n),m=r,h=c["".concat(l,".").concat(m)]||c[m]||u[m]||i;return n?a.createElement(h,o(o({ref:t},d),{},{components:n})):a.createElement(h,o({ref:t},d))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[c]="string"==typeof e?e:r,o[1]=s;for(var p=2;p<i;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},2556:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>p});var a=n(7462),r=(n(7294),n(3905));const i={title:"Overview"},o=void 0,s={unversionedId:"develop/api/overview",id:"develop/api/overview",title:"Overview",description:"`counterparty-lib` provides a JSON RPC 2.0-based API based off of",source:"@site/docs/develop/api/overview.md",sourceDirName:"develop/api",slug:"/develop/api/overview",permalink:"/docs/develop/api/overview",draft:!1,editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/develop/api/overview.md",tags:[],version:"current",frontMatter:{title:"Overview"},sidebar:"develop",next:{title:"Technical Specification",permalink:"/docs/develop/api/"}},l={},p=[{value:"Getting Started",id:"getting-started",level:2},{value:"General Format",id:"general-format",level:3},{value:"JSON-RPC",id:"json-rpc",level:4},{value:"REST",id:"rest",level:4},{value:"Authentication",id:"authentication",level:3},{value:"Example Implementations for JSON RPC API",id:"example-implementations-for-json-rpc-api",level:2},{value:"Python",id:"python",level:3},{value:"PHP",id:"php",level:3},{value:"curl",id:"curl",level:3},{value:"Linux",id:"linux",level:4},{value:"Windows",id:"windows",level:4},{value:"c# (RestSharp)",id:"c-restsharp",level:3},{value:"Go",id:"go",level:3},{value:"Ruby (Net::HTTP)",id:"ruby-nethttp",level:3},{value:"Example Implementations for REST API",id:"example-implementations-for-rest-api",level:2},{value:"Python",id:"python-1",level:3},{value:"curl",id:"curl-1",level:3},{value:"Linux",id:"linux-1",level:4},{value:"Windows",id:"windows-1",level:4},{value:"Example Parameters",id:"example-parameters",level:2},{value:"Signing Transactions Before Broadcasting",id:"signing-transactions-before-broadcasting",level:2},{value:"Terms &amp; Conventions",id:"terms--conventions",level:2},{value:"assets",id:"assets",level:3},{value:"subassets",id:"subassets",level:3},{value:"Quantities and balances",id:"quantities-and-balances",level:3},{value:"floats",id:"floats",level:3},{value:"Memos",id:"memos",level:3},{value:"Miscellaneous",id:"miscellaneous",level:2},{value:"Filtering Read API results",id:"filtering-read-api-results",level:3}],d={toc:p},c="wrapper";function u(e){let{components:t,...n}=e;return(0,r.kt)(c,(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"counterparty-lib")," provides a JSON RPC 2.0-based API based off of\nthat of Bitcoin Core. It is the primary means by which other applications\nshould interact with the Counterparty network."),(0,r.kt)("p",null,"The API server is started either through the ",(0,r.kt)("a",{parentName:"p",href:"/docs/advanced/cli"},(0,r.kt)("inlineCode",{parentName:"a"},"CLI interface"))," or\nwith the ",(0,r.kt)("a",{parentName:"p",href:"/docs/advanced/architecture"},(0,r.kt)("inlineCode",{parentName:"a"},"counterparty-lib"))," Python library. It listens on port\n4000 by default (14000 for ",(0,r.kt)("inlineCode",{parentName:"p"},"testnet"),") and requires HTTP Basic Authentication to connect."),(0,r.kt)("p",null,"The API includes numerous information retrieval methods, most of which begin with ",(0,r.kt)("inlineCode",{parentName:"p"},"get_"),", as well as several\n",(0,r.kt)("inlineCode",{parentName:"p"},"create_")," methods which create new Counterparty transactions. While the ",(0,r.kt)("inlineCode",{parentName:"p"},"get_")," type methods simply return the\nrequested information, the ",(0,r.kt)("inlineCode",{parentName:"p"},"create_")," methods return unsigned raw transactions which must then be signed and\nbroadcast on the Bitcoin network. This means that while ",(0,r.kt)("inlineCode",{parentName:"p"},"counterparty-server")," requires Bitcoin Core and\nuses it for retieval and parsing of blockchain data, it and this API do not require Bitcoin Core's wallet functionality\nfor private key storage and transaction signing. Transaction signing and broadcast can thus\nbe accomplished using whatever means the developer sees fit (including using Bitcoin core's APIs if desired, or\na library like Bitcore, or a service like blockchain.info, and so on)."),(0,r.kt)("p",null,"In addition to the JSON RPC API, ",(0,r.kt)("inlineCode",{parentName:"p"},"counterparty-lib")," provides a complementary RESTful API also based off of that\nof Bitcoin Core's design. This REST API is still under development and will include more functionality\nin the future, and listens on the same port as JSON RPC one."),(0,r.kt)("h2",{id:"getting-started"},"Getting Started"),(0,r.kt)("p",null,"By default, the server will listen on port ",(0,r.kt)("inlineCode",{parentName:"p"},"4000")," (if on mainnet) or port ",(0,r.kt)("inlineCode",{parentName:"p"},"14000")," (on testnet) for API\nrequests."),(0,r.kt)("p",null,"Note that the main API is built on JSON-RPC 2.0, not 1.1. JSON-RPC itself is pretty lightweight, and API requests\nare made via a HTTP POST request to ",(0,r.kt)("inlineCode",{parentName:"p"},"/api/")," (note the trailing slash), with JSON-encoded data passed as the POST body."),(0,r.kt)("p",null,"The requests to the secondary REST API are made via HTTP GET to ",(0,r.kt)("inlineCode",{parentName:"p"},"/rest/"),", with request action and parameters encoded in the URL."),(0,r.kt)("h3",{id:"general-format"},"General Format"),(0,r.kt)("h4",{id:"json-rpc"},"JSON-RPC"),(0,r.kt)("p",null,"All requests must have POST data that is JSON encoded. Here's an example of the POST data for a valid API request:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'{\n  "method": "get_sends",\n  "params": {"order_by": "tx_hash",\n             "order_dir": "asc",\n             "start_block": 280537,\n             "end_block": 280539},\n  "jsonrpc": "2.0",\n  "id": 0\n}\n')),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"jsonrpc")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"id")," properties are requirements under the JSON-RPC 2.0 spec."),(0,r.kt)("p",null,"You should note that the data in ",(0,r.kt)("inlineCode",{parentName:"p"},"params")," is a JSON object (e.g. mapping), not an array. In other words,\n",(0,r.kt)("strong",{parentName:"p"},"the API only supports named arguments, not positional arguments"),' (e.g. use\n{"argument1": "value1", "argument2": "value2"} instead of ','["value1", "value2"]',"). This is the case for safety and bug-minimization reasons."),(0,r.kt)("p",null,"For more information on JSON RPC, please see the ",(0,r.kt)("a",{parentName:"p",href:"http://www.jsonrpc.org/specification"},"JSON RPC 2.0 specification"),"."),(0,r.kt)("h4",{id:"rest"},"REST"),(0,r.kt)("p",null,"For REST API all requests are made via GET where query-specific arguments are encoded as URL parameters. Moreover, the same requests can be passed via HTTP POST in order to encrypt the transaction parameters. There are only two methods supported: ",(0,r.kt)("inlineCode",{parentName:"p"},"get")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"compose"),". The URL formats are as follows, respectively:\n",(0,r.kt)("inlineCode",{parentName:"p"},"/rest/<table_name>/get?<filters>&op=<operator>"),"\n",(0,r.kt)("inlineCode",{parentName:"p"},"/rest/<message_type>/compose?<transaction arguments>")),(0,r.kt)("h3",{id:"authentication"},"Authentication"),(0,r.kt)("p",null,"The API support HTTP basic authentication to use, which is enabled if and only\nif a password is set. ",(0,r.kt)("strong",{parentName:"p"},"The default user is ",(0,r.kt)("inlineCode",{parentName:"strong"},"'rpc'"),".")),(0,r.kt)("h2",{id:"example-implementations-for-json-rpc-api"},"Example Implementations for JSON RPC API"),(0,r.kt)("p",null,"The following examples have authentication enabled and the ",(0,r.kt)("inlineCode",{parentName:"p"},"user")," set to its\ndefault value of ",(0,r.kt)("inlineCode",{parentName:"p"},"'rpc'"),". The password is not set (default: ",(0,r.kt)("inlineCode",{parentName:"p"},"'rpc'"),"). Ensure\nthese values correspond to values in your counterparty-server's configuration\nfile ",(0,r.kt)("inlineCode",{parentName:"p"},"'server.conf'"),"."),(0,r.kt)("p",null,"Submissions of examples in additional languages are welcome!"),(0,r.kt)("h3",{id:"python"},"Python"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'import json\nimport requests\nfrom requests.auth import HTTPBasicAuth\n\nurl = "http://localhost:4000/api/"\nheaders = {\'content-type\': \'application/json\'}\nauth = HTTPBasicAuth(\'rpc\', PASSWORD)\n\npayload = {\n  "method": "get_running_info",\n  "params": {},\n  "jsonrpc": "2.0",\n  "id": 0\n}\nresponse = requests.post(url, data=json.dumps(payload), headers=headers, auth=auth)\nprint("Response: ", response.text)\n')),(0,r.kt)("h3",{id:"php"},"PHP"),(0,r.kt)("p",null,"With PHP, you use the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/fguillot/JsonRPC"},"JsonRPC"),"\nlibrary."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"<?php\nrequire 'JsonRPC/src/JsonRPC/Client.php';\nuse JsonRPC\\Client;\n$client = new Client('http://localhost:4000/api/');\n$client->authentication('rpc', PASSWORD);\n\n$result = $client->execute('get_balances', array('filters' => array('field' => 'address', 'op' => '==', 'value' => '1NFeBp9s5aQ1iZ26uWyiK2AYUXHxs7bFmB')));\nprint(\"get_balances result:\\n\");\nvar_dump($result);\n\n$result2 = $client->execute('get_running_info');\nprint(\"get_running_info result:\\n\");\nvar_dump($result2);\n?>\n")),(0,r.kt)("h3",{id:"curl"},"curl"),(0,r.kt)("p",null,"Remember to surround non-numeric parameter values with the double quotes, as per ",(0,r.kt)("a",{parentName:"p",href:"http://www.jsonrpc.org/specification#examples"},"JSON-RPC 2.0 examples"),". For example, ",(0,r.kt)("inlineCode",{parentName:"p"},'"order_by": "tx_hash"')," is correct and will work, ",(0,r.kt)("inlineCode",{parentName:"p"},"\"order_by\": 'tx_hash'")," won't."),(0,r.kt)("h4",{id:"linux"},"Linux"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'curl -X POST http://127.0.0.1:4000/api/ --user rpc:$PASSWORD -H \'Content-Type: application/json; charset=UTF-8\' -H \'Accept: application/json, text/javascript\' --data-binary \'{ "jsonrpc": "2.0", "id": 0, "method": "get_running_info" }\'\n')),(0,r.kt)("h4",{id:"windows"},"Windows"),(0,r.kt)("p",null,"On Windows, depending on implementation the above curl command may need to be formatted differently due to problems that Windows has with escapes. For example this particular format was found to work with curl 7.50.1 (x86_64-w64-mingw32) on Windows 10 (x64)."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'curl -X POST http://127.0.0.1:4000/api/ --user rpc:$PASSWORD -H "Content-Type: application/json; charset=UTF-8" -H "Accept: application/json, text/javascript" --data-binary "{ \\"jsonrpc\\": \\"2.0\\", \\"id\\": 0, \\"method\\": \\"get_running_info\\" }"\n')),(0,r.kt)("h3",{id:"c-restsharp"},"c# (RestSharp)"),(0,r.kt)("p",null,"Authorization string in the example below is based on the default username/password."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'var client = new RestClient("http://127.0.0.1:4000/api/");\nvar request = new RestRequest(Method.POST);\nrequest.AddHeader("cache-control", "no-cache");\nrequest.AddHeader("authorization", "Basic cnBjOjEyMzQ=");\nrequest.AddHeader("content-type", "application/json");\nrequest.AddParameter("application/json", "{\\r\\n  \\"method\\": \\"get_running_info\\",\\r\\n  \\"params\\": {},\\r\\n  \\"jsonrpc\\": \\"2.0\\",\\r\\n  \\"id\\": 1\\r\\n}", ParameterType.RequestBody);\nIRestResponse response = client.Execute(request);\n')),(0,r.kt)("h3",{id:"go"},"Go"),(0,r.kt)("p",null,"Authorization string in the example below is based on the default username/password."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'package main\n\nimport (\n    "fmt"\n    "strings"\n    "net/http"\n    "io/ioutil"\n)\n\nfunc main() {\n\n    url := "http://127.0.0.1:4000/api/"\n\n    payload := strings.NewReader("{\\r\\n  \\"method\\": \\"get_running_info\\",\\r\\n  \\"params\\": {},\\r\\n  \\"jsonrpc\\": \\"2.0\\",\\r\\n  \\"id\\": 1\\r\\n}")\n\n    req, _ := http.NewRequest("POST", url, payload)\n\n    req.Header.Add("content-type", "application/json")\n    req.Header.Add("authorization", "Basic cnBjOjEyMzQ=")\n    req.Header.Add("cache-control", "no-cache")\n\n    res, _ := http.DefaultClient.Do(req)\n\n    defer res.Body.Close()\n    body, _ := ioutil.ReadAll(res.Body)\n\n    fmt.Println(res)\n    fmt.Println(string(body))\n\n}\n')),(0,r.kt)("h3",{id:"ruby-nethttp"},"Ruby (Net::HTTP)"),(0,r.kt)("p",null,"Authorization string in the example below is based on the default username/password."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'require \'uri\'\nrequire \'net/http\'\n\nurl = URI("http://127.0.0.1:4000/api/")\n\nhttp = Net::HTTP.new(url.host, url.port)\n\nrequest = Net::HTTP::Post.new(url)\nrequest["content-type"] = \'application/json\'\nrequest["authorization"] = \'Basic cnBjOjEyMzQ=\'\nrequest["cache-control"] = \'no-cache\'\nrequest.body = "{\\r\\n  \\"method\\": \\"get_running_info\\",\\r\\n  \\"params\\": {},\\r\\n  \\"jsonrpc\\": \\"2.0\\",\\r\\n  \\"id\\": 1\\r\\n}"\n\nresponse = http.request(request)\nputs response.read_body\n')),(0,r.kt)("h2",{id:"example-implementations-for-rest-api"},"Example Implementations for REST API"),(0,r.kt)("p",null,"The following examples don't use authentication as with default settings."),(0,r.kt)("h3",{id:"python-1"},"Python"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"import requests\n\nurl = \"http://localhost:4000/rest/\"\nheaders = {'content-type': 'application/json'}\n\nquery = 'sends/get?source=mn6q3dS2EnDUx3bmyWc6D4szJNVGtaR7zc&destination=mtQheFaSfWELRB2MyMBaiWjdDm6ux9Ezns&op=AND'\n\nresponse = requests.get(url + query, headers=headers)\nprint(\"Response: \", response.text)\n")),(0,r.kt)("h3",{id:"curl-1"},"curl"),(0,r.kt)("p",null,"These examples use the default username/password combination in URL."),(0,r.kt)("h4",{id:"linux-1"},"Linux"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'curl "http://rpc:rpc@127.0.0.1:4000/rest/sends/get?source=1B6ahDHnKtZ5GXqytHSxfcXgNoxm1q1RsP&destination=14fAoS9FPD9jx36hjCNoAqFVLNHD1NQVN5&op=AND" -H "Content-Type: application/json; charset=UTF-8" -H "Accept: application/json"\n')),(0,r.kt)("h4",{id:"windows-1"},"Windows"),(0,r.kt)("p",null,"This example was created with curl 7.50.1 (x86_64-w64-mingw32) on Windows 10. For POST encryption add ",(0,r.kt)("inlineCode",{parentName:"p"},"'-X POST'"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'curl "http://rpc:rpc@127.0.0.1:4000/rest/sends/get?source=1B6ahDHnKtZ5GXqytHSxfcXgNoxm1q1RsP&destination=14fAoS9FPD9jx36hjCNoAqFVLNHD1NQVN5&op=AND" -H "Content-Type: application/json; charset=UTF-8" -H "Accept: application/json"\n')),(0,r.kt)("h2",{id:"example-parameters"},"Example Parameters"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Fetch all balances for all assets for both of two addresses, using keyword-based arguments"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},'  payload = {\n             "method": "get_balances",\n             "params": {\n                        "filters": [{"field": "address", "op": "==", "value": "14qqz8xpzzEtj6zLs3M1iASP7T4mj687yq"},\n                                    {"field": "address", "op": "==", "value": "1bLockjTFXuSENM8fGdfNUaWqiM4GPe7V"}],\n                        "filterop": "or"\n                       },\n             "jsonrpc": "2.0",\n             "id": 0\n            }\n'))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Get all burns between blocks 280537 and 280539 where greater than .2 BTC was burned, sorting by ",(0,r.kt)("inlineCode",{parentName:"p"},"tx_hash")," (ascending order)"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},'  payload = {\n             "method": "get_burns",\n             "params": {\n                        "filters": {"field": "burned", "op": ">", "value": 20000000},\n                        "filterop": "AND",\n                        "order_by": "tx_hash",\n                        "order_dir": "asc",\n                        "start_block": 280537,\n                        "end_block": 280539\n                       },\n             "jsonrpc": "2.0",\n             "id": 0\n            }\n'))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Fetch all debits for > 2 XCP between blocks 280537 and 280539, sorting the results by quantity (descending order)"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},'  payload = {\n             "method": "get_debits",\n             "params": {\n                        "filters": [{"field": "asset", "op": "==", "value": "XCP"},\n                                    {"field": "quantity", "op": ">", "value": 200000000}],\n                        "filterop": "AND",\n                        "order_by": "quantity",\n                        "order_dir": "desc"\n                       },\n             "jsonrpc": "2.0",\n             "id": 0\n            }\n')))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Send 1 XCP (specified in satoshis) from one address to another."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},'  payload = {\n             "method": "create_send",\n             "params": {\n                        "source": "1CUdFmgK9trTNZHALfqGvd8d6nUZqH2AAf",\n                        "destination": "17rRm52PYGkntcJxD2yQF9jQqRS4S2nZ7E",\n                        "asset": "XCP",\n                        "quantity": 100000000\n                       },\n             "jsonrpc": "2.0",\n             "id": 0\n            }\n'))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Issuance (indivisible)"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},'  payload = {\n             "method": "create_issuance",\n             "params": {\n                        "source": "1CUdFmgK9trTNZHALfqGvd8d6nUZqH2AAf",\n                        "asset": "MYASSET",\n                        "quantity": 1000,\n                        "description": "my asset is cool",\n                        "divisible": false\n                       },\n             "jsonrpc": "2.0",\n             "id": 0\n            }\n'))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Transfer asset ownership"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},'  payload = {\n             "method": "create_issuance",\n             "params": {\n                        "source": "1CUdFmgK9trTNZHALfqGvd8d6nUZqH2AAf",\n                        "transfer_destination": "17rRm52PYGkntcJxD2yQF9jQqRS4S2nZ7E",\n                        "asset": "MYASSET",\n                        "quantity": 0\n                       },\n             "jsonrpc": "2.0",\n             "id": 0\n            }\n'))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Lock asset"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},'  payload = {\n             "method": "create_issuance",\n             "params": {\n                        "source": "1CUdFmgK9trTNZHALfqGvd8d6nUZqH2AAf",\n                        "asset": "MYASSET",\n                        "quantity": 0,\n                        "description": "LOCK"\n                       },\n             "jsonrpc": "2.0",\n             "id": 0\n            }\n')))),(0,r.kt)("h2",{id:"signing-transactions-before-broadcasting"},"Signing Transactions Before Broadcasting"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Note:")," Before v9.49.4, the counterparty server API provided an interface to Bitcoin Core's signing functionality through the ",(0,r.kt)("inlineCode",{parentName:"p"},"do_*"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"sign_tx")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"broadcast_tx")," methods, which have all since been removed."),(0,r.kt)("p",null,"All ",(0,r.kt)("inlineCode",{parentName:"p"},"create_")," API calls return an ",(0,r.kt)("em",{parentName:"p"},"unsigned raw transaction serialization")," as a hex-encoded string (i.e. the same format that ",(0,r.kt)("inlineCode",{parentName:"p"},"bitcoind")," returns with its raw transaction API calls). This raw transaction's inputs may be validated and then must be signed (i.e. via Bitcoin Core, a 3rd party Bitcoin library like Bitcore, etc) and broadcast on the Bitcoin network."),(0,r.kt)("p",null,"The process of signing and broadcasting a transaction, from start to finish, depends somewhat on the wallet software used. Below are examples of how one might use a wallet to sign and broadcast an unsigned Counterparty transaction ",(0,r.kt)("em",{parentName:"p"},"created")," with this API."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Bitcoin Core with Python")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"#! /usr/bin/env python3\n\nfrom counterpartylib.lib import util\nfrom counterpartylib.lib import config\nfrom counterpartylib.lib.backend import addrindex\n\nconfig.TESTNET =\nconfig.RPC =\nconfig.BACKEND_URL =\nconfig.BACKEND_SSL_NO_VERIFY =\n\ndef counterparty_api(method, params):\n    return util.api(method, params)\n\ndef bitcoin_api(method, params):\n    return addrindex.rpc(method, params)\n\ndef do_send(source, destination, asset, quantity, fee, encoding):\n    validateaddress = bitcoin_api('validateaddress', [source])\n    assert validateaddress['ismine']\n    pubkey = validateaddress['pubkey']\n    unsigned_tx = counterparty_api('create_send', {'source': source, 'destination': destination, 'asset': asset, 'quantity': quantity, 'pubkey': pubkey, 'allow_unconfirmed_inputs': True})\n    signed_tx = bitcoin_api('signrawtransaction', [unsigned_tx])['hex']\n    tx_hash = bitcoin_api('sendrawtransaction', [signed_tx])\n    return tx_hash\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Bitcoin Core with Javascript"),"\n(Utilizing the ",(0,r.kt)("a",{parentName:"p",href:"https://raw.githubusercontent.com/CounterpartyXCP/counterwallet/master/src/js/util.bitcore.js"},"Counterwallet Bitcore wrapper code")," for brevity.)"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"<html>\n    <script src=\"https://raw.githubusercontent.com/bitpay/bitcore-lib/f031e1ddfbf0064ef503a28aada86c4fbf9a414c/bitcore-lib.min.js\"><\/script>\n    <script src=\"https://raw.githubusercontent.com/CounterpartyXCP/counterwallet/master/src/js/util.bitcore.js\"><\/script>\n    <script src=\"https://raw.githubusercontent.com/CounterpartyXCP/counterwallet/master/src/js/external/mnemonic.js\"><\/script>\n    <script>\n    counterparty_api = function(method, params) {\n        // call Counterparty API method via your prefered method\n    }\n\n    bitcoin_api = function(method, params) {\n        // call Bitcoin Core API method via your prefered method\n    }\n\n    // generate a passphrase\n    var m = new Mnemonic(128); //128 bits of entropy (12 word passphrase)\n    var words = m.toWords();\n    var passphrase = words.join(' ')\n\n    // generate private key, public key and address from the passphrase\n    wallet = new CWHierarchicalKey(passphrase);\n    var cwk = wallet.getAddressKey(i); // i the number of the address\n    var source = key.getAddress();\n    var pubkey = cwk.getPub()\n\n    // generate unsigned transaction\n    unsigned_hex = counterparty_api('create_send', {'source': source, 'destination': destination, 'asset': asset, 'quantity': quantity, 'pubkey': pubkey})\n\n    CWBitcore.signRawTransaction2(self.unsignedTx(), cwk, function(signedHex) {\n        bitcoin_api('sendrawtransaction', signedHex)\n    })\n    <\/script>\n</html>\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Bitcoinjs-lib on javascript, signing a P2SH redeeming transaction")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"// Assumes NodeJS runtime. Several libraries exist to replace the Buffer class on web browsers\nconst bitcoin = require('bitcoinjs-lib')\n\nasync function signP2SHDataTX(wif, txHex) {\n  const network = bitcoin.networks.testnet // Change appropiately to your used network\n  const keyPair = bitcoin.ECPair.fromWIF(wif, network)\n  const dataTx = bitcoin.Transaction.fromHex(txHex)   // The unsigned second part of the 2 part P2SH transactions\n\n  const sigType = bitcoin.Transaction.SIGHASH_ALL // This shouldn't be changed unless you REALLY know what you're doing\n  \n  for (let i=0; i < dataTx.ins.length; i++) {\n    const sigHash = dataTx.hashForSignature(i, bitcoin.script.decompile(dataTx.ins[i].script)[0], sigType)\n    const sig = keyPair.sign(sigHash)\n    const encodedSig = bitcoin.script.signature.encode(sig, sigType)\n    const compiled = bitcoin.script.compile([encodedSig])\n\n    dataTx.ins[i].script = Buffer.concat([compiled, dataTx.ins[i].script])\n  }\n\n  dataTx.ins[0].script = Buffer.concat([compiled, dataTx.ins[0].script])\n  return dataTx.toHex() // The resulting signed transaction in raw hex, ready to be broadcasted\n}\n")),(0,r.kt)("h2",{id:"terms--conventions"},"Terms & Conventions"),(0,r.kt)("h3",{id:"assets"},"assets"),(0,r.kt)("p",null,"Everywhere in the API an asset is referenced by its name, not its ID. See the ",(0,r.kt)("a",{parentName:"p",href:"../../../../docs/advanced/protocol/#assets"},"Counterparty protocol specification")," for what constitutes a valid asset name.\nExamples:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},'"BTC"'),(0,r.kt)("li",{parentName:"ul"},'"XCP"'),(0,r.kt)("li",{parentName:"ul"},'"FOOBAR"'),(0,r.kt)("li",{parentName:"ul"},'"A7736697071037023001"')),(0,r.kt)("h3",{id:"subassets"},"subassets"),(0,r.kt)("p",null,"See the ",(0,r.kt)("a",{parentName:"p",href:"../../../../docs/advanced/protocol/#subassets"},"Counterparty protocol specification")," for what constitutes a valid subasset name.\nExamples:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},'"PIZZA.X"'),(0,r.kt)("li",{parentName:"ul"},'"PIZZA.REALLY-long-VALID-Subasset-NAME"')),(0,r.kt)("h3",{id:"quantities-and-balances"},"Quantities and balances"),(0,r.kt)("p",null,"Anywhere where an quantity is specified, it is specified in ",(0,r.kt)("strong",{parentName:"p"},"satoshis")," (if a divisible asset), or as whole numbers\n(if an indivisible asset). To convert satoshis to floating-point, simply cast to float and divide by 100,000,000."),(0,r.kt)("p",null,"Examples:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"4381030000 = 43.8103 (if divisible asset)"),(0,r.kt)("li",{parentName:"ul"},"4381030000 = 4381030000 (if indivisible asset)")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"NOTE:")," XCP and BTC themselves are divisible assets."),(0,r.kt)("h3",{id:"floats"},"floats"),(0,r.kt)("p",null,"Floats are ratios or floating point values with six decimal places of precision, used in bets and dividends."),(0,r.kt)("h3",{id:"memos"},"Memos"),(0,r.kt)("p",null,"See the ",(0,r.kt)("a",{parentName:"p",href:"../../../advanced/protocol/#memos"},"Counterparty protocol specification")," for what constitutes a valid memo.\nExamples:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},'"for pizza"'),(0,r.kt)("li",{parentName:"ul"},'"1ca6"')),(0,r.kt)("h2",{id:"miscellaneous"},"Miscellaneous"),(0,r.kt)("h3",{id:"filtering-read-api-results"},"Filtering Read API results"),(0,r.kt)("p",null,"The Counterparty API aims to be as simple and flexible as possible. To this end, it includes a straightforward\nway to filter the results of most ",(0,r.kt)("a",{parentName:"p",href:"/docs/develop/api/#read-api-function-reference"},"Read API")," to get the data you want, and only that."),(0,r.kt)("p",null,"For each Read API function that supports it, a ",(0,r.kt)("inlineCode",{parentName:"p"},"filters")," parameter exists. To apply a filter to a specific data field,\nspecify an object (e.g. dict in Python) as this parameter, with the following members:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"field: The field to filter on. Must be a valid field in the type of object being returned"),(0,r.kt)("li",{parentName:"ul"},"op: The comparison operation to perform. One of: ",(0,r.kt)("inlineCode",{parentName:"li"},'"=="'),", ",(0,r.kt)("inlineCode",{parentName:"li"},'"!="'),", ",(0,r.kt)("inlineCode",{parentName:"li"},'">"'),", ",(0,r.kt)("inlineCode",{parentName:"li"},'"<"'),", ",(0,r.kt)("inlineCode",{parentName:"li"},'">="'),", ",(0,r.kt)("inlineCode",{parentName:"li"},'"<="'),", ",(0,r.kt)("inlineCode",{parentName:"li"},'"IN"'),", ",(0,r.kt)("inlineCode",{parentName:"li"},'"LIKE"'),", ",(0,r.kt)("inlineCode",{parentName:"li"},'"NOT IN"'),", ",(0,r.kt)("inlineCode",{parentName:"li"},'"NOT LIKE"')),(0,r.kt)("li",{parentName:"ul"},"value: The value that the field will be compared against. Must be the same data type as the field is\n(e.g. if the field is a string, the value must be a string too)")),(0,r.kt)("p",null,"If you want to filter by multiple fields, then you can specify a list of filter objects. To this end, API functions\nthat take ",(0,r.kt)("inlineCode",{parentName:"p"},"filters")," also take a ",(0,r.kt)("inlineCode",{parentName:"p"},"filterop")," parameter, which determines how the filters are combined when multiple\nfilters are specified. It defaults to ",(0,r.kt)("inlineCode",{parentName:"p"},'"and"'),", meaning that filters are ANDed togeher (and that any match\nmust satisfy all of them). You can also specify ",(0,r.kt)("inlineCode",{parentName:"p"},'"or"')," as an alternative setting, which would mean that\nfilters are ORed together, and that any match must satisfy only one of them."),(0,r.kt)("p",null,"To disable filtering, you can just not specify the filter argument (if using keyword-based arguments), or,\nif using positional arguments, just pass ",(0,r.kt)("inlineCode",{parentName:"p"},"null")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"[]")," (empty list) for the parameter."),(0,r.kt)("p",null,"For examples of filtering in-use, please see the ",(0,r.kt)("a",{parentName:"p",href:"#example-parameters"},"examples"),"."),(0,r.kt)("p",null,"NOTE: Note that with strings being compared, operators like ",(0,r.kt)("inlineCode",{parentName:"p"},">=")," do a lexigraphic string comparison (which\ncompares, letter to letter, based on the ASCII ordering for individual characters. For more information on\nthe specific comparison logic used, please see ",(0,r.kt)("a",{parentName:"p",href:"http://www.sqlite.org/lang_expr.html"},"this page"),"."))}u.isMDXComponent=!0}}]);