"use strict";(self.webpackChunkxcpdoc=self.webpackChunkxcpdoc||[]).push([[380],{5859:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>o,default:()=>p,frontMatter:()=>d,metadata:()=>s,toc:()=>i});var r=n(4848),c=n(8453);const d={title:"Docker Kickstart"},o=void 0,s={id:"advanced/how-to/docker-kickstart",title:"Docker Kickstart",description:"1) Create a persistent volume",source:"@site/docs/advanced/how-to/docker-kickstart.md",sourceDirName:"advanced/how-to",slug:"/advanced/how-to/docker-kickstart",permalink:"/docs/advanced/how-to/docker-kickstart",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/advanced/how-to/docker-kickstart.md",tags:[],version:"current",frontMatter:{title:"Docker Kickstart"},sidebar:"advanced",previous:{title:"API v1 ChangeLog",permalink:"/docs/advanced/api-v1/api-v1-changelog"},next:{title:"Sentry Integration",permalink:"/docs/advanced/how-to/sentry-integration"}},a={},i=[{value:"1) Create a persistent volume",id:"1-create-a-persistent-volume",level:3},{value:"2) Start <code>bitcoind</code>",id:"2-start-bitcoind",level:3},{value:"3) Start <code>addrindexrs</code>",id:"3-start-addrindexrs",level:3},{value:"4) Run kickstart",id:"4-run-kickstart",level:3}];function l(e){const t={code:"code",h3:"h3",p:"p",pre:"pre",...(0,c.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h3,{id:"1-create-a-persistent-volume",children:"1) Create a persistent volume"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"docker volume create -d local -o type=none -o o=bind -o device=<BITCOIN_DATA_DIR>/ data\n"})}),"\n",(0,r.jsxs)(t.h3,{id:"2-start-bitcoind",children:["2) Start ",(0,r.jsx)(t.code,{children:"bitcoind"})]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"docker run --name bitcoind -v data:/bitcoin/.bitcoin -p 8332:8332 kylemanna/bitcoind:latest -chain=main -rpcallowip=0.0.0.0/0 -rpcbind=0.0.0.0 -rpcuser=rpc -rpcpassword=rpc -listen=1 -server=1 -printtoconsole=1 -addresstype=legacy -txindex=1 -prune=0 -dbcache=4000 -mempoolfullrbf=1\n"})}),"\n",(0,r.jsxs)(t.h3,{id:"3-start-addrindexrs",children:["3) Start ",(0,r.jsx)(t.code,{children:"addrindexrs"})]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"export DAEMON_RPC_HOST=$(docker inspect -f '{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}' bitcoind)\n\ndocker run --name addrindexrs -v data:/root/.bitcoin -v data:/data -p 8432:8432 -e ADDRINDEXRS_JSONRPC_IMPORT=${ADDRINDEXRS_JSONRPC_IMPORT:-false} counterparty/addrindexrs:v0.4.6 --network=main --indexer-rpc-host=0.0.0.0 --daemon-rpc-host=$DAEMON_RPC_HOST --daemon-rpc-port=8332 --cookie=rpc:rpc -vvv --db-dir=/data/\n"})}),"\n",(0,r.jsx)(t.h3,{id:"4-run-kickstart",children:"4) Run kickstart"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"export DAEMON_RPC_HOST=$(docker inspect -f '{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}' bitcoind)\nexport ADDRINDEXRS_HOST=$(docker inspect -f '{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}' addrindexrs)\n\ndocker run -it -v data:/root/.bitcoin -v data:/data -p 4000:4000 -e XDG_DATA_HOME=/data/ -e XDG_LOG_HOME=/data/ counterparty/counterparty:latest kickstart --mainnet --backend-connect=$DAEMON_RPC_HOST --indexd-connect=$ADDRINDEXRS_HOST --rpc-host=0.0.0.0 -v\n"})}),"\n",(0,r.jsxs)(t.p,{children:["If the kickstart stops after a few blocks, try adding the ",(0,r.jsx)(t.code,{children:"--ipc=host"})," flag to ",(0,r.jsx)(t.code,{children:"docker run"}),"."]}),"\n",(0,r.jsxs)(t.p,{children:["Follow on screen prompt and kill ",(0,r.jsx)(t.code,{children:"bitcoind"})," when ",(0,r.jsx)(t.code,{children:"addrindexrs"})," is done syncing."]}),"\n",(0,r.jsx)(t.p,{children:"bash"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"docker stop bitcoind\n"})}),"\n",(0,r.jsxs)(t.p,{children:["Press ",(0,r.jsx)(t.code,{children:"y"})," to continue kickstart"]}),"\n",(0,r.jsxs)(t.p,{children:["Note: Due to resource limitations, this process can sometimes stall.  If you ",(0,r.jsx)(t.code,{children:"ctrl-c"})," and then restart, ",(0,r.jsx)(t.code,{children:"kickstart"})," will pick up where it left off."]}),"\n",(0,r.jsx)(t.p,{children:"bash"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"docker stop bitcoind\n"})}),"\n",(0,r.jsxs)(t.p,{children:["Press ",(0,r.jsx)(t.code,{children:"y"})," to continue kickstart."]})]})}function p(e={}){const{wrapper:t}={...(0,c.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>s});var r=n(6540);const c={},d=r.createContext(c);function o(e){const t=r.useContext(d);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:o(e.components),r.createElement(d.Provider,{value:t},e.children)}}}]);