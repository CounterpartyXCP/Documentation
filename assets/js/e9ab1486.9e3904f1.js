"use strict";(self.webpackChunkxcpdoc=self.webpackChunkxcpdoc||[]).push([[549],{8453:(e,s,t)=>{t.d(s,{R:()=>i,x:()=>c});var n=t(6540);const o={},a=n.createContext(o);function i(e){const s=n.useContext(a);return n.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),n.createElement(a.Provider,{value:s},e.children)}},9706:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>r,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"advanced/specifications/utxo-support","title":"UTXO Support","description":"With UTXO support, it is possible to attach / detach Counterparty assets directly to / from Bitcoin UTXOs, so that they can be spent just like Colored Coins\u2013based protocols (such as Ordinals and Runes) using any Bitcoin wallets with support for sat tracking. This featuer enables single-transaction, trustless atomic swaps between BTC and Counterparty assets, as well as Counterparty assets and other L2 protocols. Attaching assets to UTXOs uses the new gas system that allows for a dynamic XCP fee for transactions to reduce the barrier to entry into Counterparty for new users.","source":"@site/docs/advanced/specifications/utxo-support.md","sourceDirName":"advanced/specifications","slug":"/advanced/specifications/utxo-support","permalink":"/docs/advanced/specifications/utxo-support","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/edit/master/website/docs/advanced/specifications/utxo-support.md","tags":[],"version":"current","frontMatter":{},"sidebar":"advanced","previous":{"title":"Subassets on Numeric Assets","permalink":"/docs/advanced/specifications/allow-subassets-on-numerics"},"next":{"title":"Gas System","permalink":"/docs/advanced/specifications/gas-system"}}');var o=t(4848),a=t(8453);const i={},c="UTXO Support",r={},d=[{value:"Attach",id:"attach",level:2},{value:"Detach",id:"detach",level:2},{value:"Move",id:"move",level:2}];function l(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.header,{children:(0,o.jsx)(s.h1,{id:"utxo-support",children:"UTXO Support"})}),"\n",(0,o.jsx)(s.h1,{id:"motivations",children:"Motivations"}),"\n",(0,o.jsxs)(s.p,{children:["With UTXO support, it is possible to ",(0,o.jsx)(s.strong,{children:"attach"})," / ",(0,o.jsx)(s.strong,{children:"detach"})," Counterparty assets directly to / from Bitcoin UTXOs, so that they can be spent just like Colored Coins\u2013based protocols (such as Ordinals and Runes) using any Bitcoin wallets with support for sat tracking. This featuer enables single-transaction, trustless atomic swaps between BTC and Counterparty assets, as well as Counterparty assets and other L2 protocols. Attaching assets to UTXOs uses the ",(0,o.jsx)(s.a,{href:"/docs/advanced/specifications/gas-system",children:"new gas system"})," that allows for a dynamic XCP fee for transactions to reduce the barrier to entry into Counterparty for new users."]}),"\n",(0,o.jsx)(s.h1,{id:"design",children:"Design"}),"\n",(0,o.jsx)(s.h2,{id:"attach",children:"Attach"}),"\n",(0,o.jsxs)(s.ol,{children:["\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:"It is possible to attach an arbitrary number of assets from an address to a UTXO."}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["Assets are attached from transaction source address to the first UTXO non-",(0,o.jsx)(s.code,{children:"OP_RETURN"})," output or, if provided, to the ",(0,o.jsx)(s.code,{children:"destination_vout"})," output."]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["If ",(0,o.jsx)(s.code,{children:"destination_vout"})," designates an invalid output (",(0,o.jsx)(s.code,{children:"OP_RETURN"})," or non-existent) or if the transaction contains only a single OP_RETURN output, the transaction is invalid."]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["Fees in XCP, calculated using the ",(0,o.jsx)(s.a,{href:"/docs/advanced/specifications/gas-system",children:"new gas system"}),", will be paid by the ",(0,o.jsx)(s.code,{children:"source"})," address for an ",(0,o.jsx)(s.code,{children:"attach"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["For each ",(0,o.jsx)(s.code,{children:"attach"}),", a row will be added to the ",(0,o.jsx)(s.code,{children:"send"})," table, triggering the ",(0,o.jsx)(s.code,{children:"ATTACH_TO_UTXO"})," event."]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["When assets are attached to a UTXO, it is impossible to use them for a Counterparty transaction (",(0,o.jsx)(s.code,{children:"order"}),", ",(0,o.jsx)(s.code,{children:"send"}),", etc.), apart from ",(0,o.jsx)(s.code,{children:"detach"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["The embedded data in a ",(0,o.jsx)(s.code,{children:"attach"})," transaction is small enough that an ",(0,o.jsx)(s.code,{children:"OP_RETURN"})," output is always sufficient."]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(s.h2,{id:"detach",children:"Detach"}),"\n",(0,o.jsxs)(s.ol,{children:["\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["All inputs of every ",(0,o.jsx)(s.code,{children:"detach"})," transaction are detached."]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["If no ",(0,o.jsx)(s.code,{children:"destination"})," is provided, the assets are sent to the address corresponding to the detached input."]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["It is impossible to perform a ",(0,o.jsx)(s.code,{children:"move"})," at the same time as a ",(0,o.jsx)(s.code,{children:"detach"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["For each ",(0,o.jsx)(s.code,{children:"detach"}),", a row will be added to the ",(0,o.jsx)(s.code,{children:"send"})," table, triggering the ",(0,o.jsx)(s.code,{children:"DETACH_FROM_UTXO"})," event."]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["The embedded data in a ",(0,o.jsx)(s.code,{children:"detach"})," transaction is small enough that an ",(0,o.jsx)(s.code,{children:"OP_RETURN"})," output is always sufficient."]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(s.h2,{id:"move",children:"Move"}),"\n",(0,o.jsxs)(s.ol,{children:["\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.code,{children:"utxo.move_assets()"})," is executed before all Counterparty contracts, except for ",(0,o.jsx)(s.code,{children:"attach"})," transaction."]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["When a UTXO is spent, a row is added to the ",(0,o.jsx)(s.code,{children:"send"})," table for each asset attached to this UTXO, triggering a ",(0,o.jsx)(s.code,{children:"UTXO_MOVE"})," event."]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(s.h1,{id:"api",children:"API"}),"\n",(0,o.jsxs)(s.ol,{children:["\n",(0,o.jsx)(s.li,{children:"API routes"}),"\n"]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-python",children:'"/v2/addresses/<address>/compose/attach": compose.compose_attach,\n"/v2/utxos/<utxo>/compose/detach": compose.compose_detach,\n"/v2/utxos/<utxo>/compose/movetoutxo": compose.compose_movetoutxo,\n"/v2/compose/attach/estimatexcpfees": compose.get_attach_estimate_xcp_fee,\n'})}),"\n",(0,o.jsxs)(s.ol,{children:["\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:"To prevent assets from being moved unintentionally, the transaction composition API excludes UTXOs with assets attached by default."}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["Balances contain two fields for UTXO support: ",(0,o.jsx)(s.code,{children:"utxo"})," and ",(0,o.jsx)(s.code,{children:"utxo_address"}),"."]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,a.R)(),...e.components};return s?(0,o.jsx)(s,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}}}]);